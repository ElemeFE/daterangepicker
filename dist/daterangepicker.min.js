!function t(e,n,a){function r(i,o){if(!n[i]){if(!e[i]){var l="function"==typeof require&&require;if(!o&&l)return l(i,!0);if(s)return s(i,!0);throw new Error("Cannot find module '"+i+"'")}var c=n[i]={exports:{}};e[i][0].call(c.exports,function(t){var n=e[i][1][t];return r(n?n:t)},c,c.exports,t,e,n,a)}return n[i].exports}for(var s="function"==typeof require&&require,i=0;i<a.length;i++)r(a[i]);return r}({1:[function(t,e,n){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),s=t("./tools/element").create,i=moment(),o=function(){function t(e,n){a(this,t);var r=e.el,i=e.config,o=i.numberOfCalendars,l=i.lang,c=i.maxDate,u=i.minDate;this.el=s("div","drp-calendar"),this.parent=r,this.calNum=o,this.current=e.range?moment(e.range.start):e.date?moment(e.date):moment(),this.reload=n,this.lang=l,c&&(this.maxDate=c.endOf("day")),u&&(this.minDate=u.startOf("day")),this.draw(),r.appendChild(this.el)}return r(t,[{key:"draw",value:function(t){t&&(this.current=moment(t)),moment.locale(this.lang||"zh-cn"),this.el.innerHTML="",this.month=[],this.current=this.current.subtract(Math.ceil(this.calNum/2),"month"),this.drawPointer();for(var e=0;e<this.calNum;e++)this.current=this.current.date(1).add(1,"month"),this.drawHeader(e),this.drawMonth(e)}},{key:"drawPointer",value:function(){var t=this,e=s("div","drp-right");e.addEventListener("click",function(){t.nextMonth()});var n=s("div","drp-left");n.addEventListener("click",function(){t.prevMonth()}),this.parent.appendChild(e),this.parent.appendChild(n)}},{key:"drawHeader",value:function(t){this.header=s("div","drp-header",this.current.format("MMM YYYY")),this.el.appendChild(this.header),this.drawWeekDays(),this.header.innerHTML=this.current.format("MMM YYYY")}},{key:"drawMonth",value:function(t){this.month.push(s("div","drp-month")),this.backFill(),this.currentMonth(),this.fowardFill(),this.el.appendChild(this.month[this.month.length-1])}},{key:"backFill",value:function(){var t=this.current.clone(),e=t.day();if(e){t.subtract(e+1,"days");for(var n=e;n>0;n--)this.drawDay(t.add(1,"days"))}}},{key:"fowardFill",value:function(){var t=this.current.clone().add(1,"months").subtract(1,"days"),e=t.day();if(6!==e)for(var n=e;6>n;n++)this.drawDay(t.add(1,"days"))}},{key:"currentMonth",value:function(){for(var t=this.current.clone();t.month()===this.current.month();)this.drawDay(t),t.add(1,"days")}},{key:"getWeek",value:function(t){this.week&&0!==t.day()||(this.week=s("div","drp-week"),this.month[this.month.length-1].appendChild(this.week))}},{key:"drawDay",value:function(t){this.getWeek(t);var e=s("div",this.getDayClass(t)),n="drp-day-number";(this.minDate&&t.isBefore(this.minDate)||this.maxDate&&t.isAfter(this.maxDate))&&(n="drp-day-static");var a=s("div",n,t.format("DD"));a.setAttribute("date",t.format("YYYY-MM-DD")),e.appendChild(a),this.week.appendChild(e)}},{key:"getDayClass",value:function(t){var e=["drp-day"];return t.month()!==this.current.month()?e.push("drp-other"):i.isSame(t,"day")&&e.push("drp-today"),e.join(" ")}},{key:"drawWeekDays",value:function(t){var e=this;this.weekDays=s("div","drp-week-days");for(var n=[],a=0;7>a;a++)n.push(moment().weekday(a-1).format("ddd"));n.forEach(function(t){var n=s("span","drp-day",t);e.weekDays.appendChild(n)}),this.el.appendChild(this.weekDays)}},{key:"nextMonth",value:function(){this.current.subtract(Math.floor(this.calNum/2)-1,"months"),this.next=!0,this.draw(),this.reload()}},{key:"prevMonth",value:function(){this.current.subtract(Math.floor(this.calNum/2)+1,"months"),this.next=!1,this.draw(),this.reload()}}]),t}();e.exports=o},{"./tools/element":10}],2:[function(t,e,n){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),s=t("./Calendar"),i=t("./TimePicker"),o=t("./Shortcuts"),l=t("./Dimension"),c=t("./events/bind"),u=t("./events/events"),h=u.click,m=u.hover,d=u.reload,f=u.leave,g=t("./tools/mouseleave"),p=t("./tools/element"),v=t("./tools/getter"),y=v.zero,E=function(){function t(e,n){var r=this;a(this,t);var s=n.type,i=n.date,c=n.range,u=n.onSelect,h=n.lang,m=n.shortcuts,d=n.dimension;n.lang=h=h||"zh-cn",this.el=e,this.config=n,this.targetElements=[],this.rangeElements=[[],[],[]],this.firstItem=null,this.range=c?function(){return c.start=c.start.locale(h),c.end=c.end.locale(h),c}():null,this.date=i?i.locale(h):null,this.interval=null,this.time=null,this.calendar=null,m&&m.el&&(this.shortcuts=new o(this,m)),d&&d.el&&"terminal"===s&&(this.dimension=new l(this,m)),this.selectFunc=u?function(t){if("single"===s){if(t=t||r.date,r.shortcuts&&r.shortcuts.setInput(s,t),!r.time)return u(t);var e=r.time,n=e.hours,a=e.minutes;r.date=t.hours(n[0]).minutes(a[0]),u(r.date)}else if("range"===s||"terminal"===s){if(t=t||r.range,r.shortcuts&&r.shortcuts.setInput(s,t),!r.time)return u(t);var i=r.time,n=i.hours,a=i.minutes;r.range.start=t.start.hours(n[0]).minutes(a[0]),r.range.end=t.end.hours(n[1]).minutes(a[1]),u(r.range)}}:null,this.init()}return r(t,[{key:"init",value:function(){var t=this,e=this.el,n=this.config;this.calendar=new s(this,function(){d(t)}),n.time&&(this.time=new i(this)),e.className="drp",e.addEventListener("click",function(e){c(e,h,t)}),e.addEventListener("mouseover",function(n){c(n,m,t),g.getTarget(e)||g.setTarget(e)}),g.add(e,function(){f(t)}),d(this,!0)}},{key:"set",value:function(t,e){if("undefined"!=typeof this[t]&&e){var n=this.config,a=n.type,r=n.lang;if("date"===t){if(this.date&&this.date.isSame(e))return;e=e.locale(r),this.shortcuts&&this.shortcuts.setInput(a,e)}else if("range"===t||"terminal"===a){if(this.range&&this.range.isSame(e))return;e.start=e.start.locale(r),e.end=e.end.locale(r),"terminal"===a&&(this.interval=e.diff("days")),this.shortcuts&&this.shortcuts.setInput(a,e)}this[t]=e,this.time&&this.time.setTime(e),this.calendar.draw(e.start||e),d(this)}}},{key:"clear",value:function(){var t=this.el,e=this.date,n=this.range;this.config;n&&(p.clear(t,n),this.range=null,this.time&&this.time.setTime(moment.range([y,y]))),e&&(p.exchangeClass(this.targetElements,"",t,["focus"]),this.date=null,this.time&&this.time.setTime(moment(y)))}}]),t}();e.exports=E},{"./Calendar":1,"./Dimension":3,"./Shortcuts":4,"./TimePicker":5,"./events/bind":6,"./events/events":7,"./tools/element":10,"./tools/getter":12,"./tools/mouseleave":13}],3:[function(t,e,n){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=(t("./tools/element").create,t("./lang"),function s(t,e){a(this,s)});e.exports=r},{"./lang":9,"./tools/element":10}],4:[function(t,e,n){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),s=t("./tools/element").create,i=t("./lang"),o=t("./tools/getter").format,l=function(){function t(e,n){var r=this;a(this,t),this.lang=i[e.config.lang],this.el=n.el,this.btns=n.btns,this.dateEL=null,this.rangeStartEL=null,this.rangeEndEL=null,this.formEL=null,this.btns&&this.btns.length||(this.btns=["today","yesterday","lastWeek","lastMonth","custom"]),this.btns.forEach(function(t){r.lang[t]&&r.setBtn(e,r.lang[t])}),this.formEL=s("form","drp-shortcuts-form"),this.formEL.style.display="none";var l=s("button","drp-shortcuts-selectbtn",this.lang.select);if(l.type="button",-1!==this.btns.indexOf("custom")){var c=e.config,u=c.minDate,h=c.maxDate,m=c.type;"single"===m?(this.dateEL=s("input","drp-shortcuts-input",o(e.date)),this.formEL.appendChild(this.dateEL),this.formEL.appendChild(l),l.addEventListener("click",function(t){var n=moment(r.dateEL.value);n.isValid()&&(n.isBefore(u)&&(n=u),n.isAfter(h)&&(n=h),n.isSame(e.date)||(e.set("date",n),e.selectFunc())),r.dateEL.value=o(e.date)})):(this.rangeStartEL=s("input","drp-shortcuts-input",o(e.range.start)),this.rangeEndEL=s("input","drp-shortcuts-input",o(e.range.end)),this.formEL.appendChild(this.rangeStartEL),this.formEL.appendChild(this.rangeEndEL),this.formEL.appendChild(l),l.addEventListener("click",function(t){var n=moment(r.rangeStartEL.value),a=moment(r.rangeEndEL.value);n.isValid()&&a.isValid&&(n.isAfter(a)&&(n=a),n.isBefore(u)&&(n=u),a.isAfter(h)&&(a=h),moment.range(n,a).isSame(e.range)||(e.set("range",moment.range(n,a)),e.selectFunc())),r.rangeStartEL.value=o(e.range.start),r.rangeEndEL.value=o(e.range.end)}))}this.el.appendChild(this.formEL)}return r(t,[{key:"setBtn",value:function(t,e){var n=this;if("single"!==t.config.type||e!==this.lang.lastWeek&&e!==this.lang.lastMonth){var a=s("a","drp-shortcuts-btn",e);a.addEventListener("click",function(e){var a="single"===t.config.type,r=moment().startOf("day"),s=moment().startOf("day").subtract(1,"days"),i=-1!==n.btns.indexOf("today")&&-1===n.btns.indexOf("yesterday"),o=moment.range(i?moment(s).subtract(1,"days"):moment(r).subtract(6,"days"),i?s:r),l=moment.range(i?moment(s).subtract(1,"months").add(1,"days"):moment(r).subtract(1,"months").add(1,"days"),i?s:r);switch(n.exchangeButton(e.target),n.formEL.style.display="none",e.target.innerHTML){case n.lang.today:a?t.set("date",r):t.set("range",moment.range(r,r)),t.selectFunc();break;case n.lang.yesterday:a?t.set("date",s):t.set("range",moment.range(s,s)),t.selectFunc();break;case n.lang.lastWeek:a||t.set("range",o),t.selectFunc();break;case n.lang.lastMonth:a||t.set("range",l),t.selectFunc();break;case n.lang.custom:n.formEL.style.display="block"}}),this.el.appendChild(a)}}},{key:"setInput",value:function(t,e){"single"===t?this.dateEL.value=o(e):(this.rangeStartEL.value=o(e.start),this.rangeEndEL.value=o(e.end))}},{key:"exchangeButton",value:function(t){Array.prototype.slice.call(this.el.querySelectorAll(".drp-shortcuts-btn")).forEach(function(t){t.classList.remove("focus")}),t.classList.add("focus")}}]),t}();e.exports=l},{"./lang":9,"./tools/element":10,"./tools/getter":12}],5:[function(t,e,n){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),s=t("./tools/element").create,i=t("./tools/getter"),o=i.zero,l=function(){function t(e){a(this,t);var n=e.el,r=e.config,s=e.selectFunc;this.el=n,this.config=r,this.selectFunc=s,this.hours=[],this.minutes=[],this.timeText=null,this.secondTimeText=null,this.input=[],this.init(e)}return r(t,[{key:"init",value:function(t){var e=this.config.type,n=s("div","drp-time");this.timeText=s("div","drp-time-text");var a=moment(o);if("single"===e)n.appendChild(this.timeText),n.appendChild(this.createInput(!0,t.date||a)),n.appendChild(this.createInput(!1,t.date||a));else if("range"===e||"terminal"===e){this.secondTimeText=s("div","drp-time-text");var r=t.range?t.range.start:a,i=t.range?t.range.end:a;n.appendChild(this.insertItemBox(this.timeText,this.createInput(!0,r,!0),this.createInput(!1,r,!0))),n.appendChild(this.insertItemBox(this.secondTimeText,this.createInput(!0,i,!1),this.createInput(!1,i,!1)))}this.el.appendChild(n)}},{key:"insertItemBox",value:function(t,e,n){var a=s("div","drp-time-item");return a.appendChild(t),a.appendChild(e),a.appendChild(n),a}},{key:"createInput",value:function(t,e,n){var a=this,r=s("input","drp-time-input");return r.type="range",r.min=0,r.max=t?23:59,this.input.push(r),this.setParams(t,e,n),r.addEventListener("input",function(r){e=t?e.hours(r.target.value):e.minutes(r.target.value),a.setParams(t,e,n),a.selectFunc(null)}),r}},{key:"setParams",value:function(t,e,n){var a=this.config.type;"single"===a?(this.timeText.innerHTML=e.format("LT"),t?this.input[0].value=this.hours[0]=e.format("HH"):this.input[1].value=this.minutes[0]=e.format("mm")):("range"===a||"terminal"===a)&&(n?(this.timeText.innerHTML=e.format("LT"),t?this.input[0].value=this.hours[0]=e.format("HH"):this.input[1].value=this.minutes[0]=e.format("mm")):(this.secondTimeText.innerHTML=e.format("LT"),t?this.input[2].value=this.hours[1]=e.format("HH"):this.input[3].value=this.minutes[1]=e.format("mm")))}},{key:"setTime",value:function(t){var e=this.config.type;"single"===e?(this.setParams(!0,t),this.setParams(!1,t)):("range"===e||"terminal"===e)&&(this.setParams(!0,t.start,!0),this.setParams(!1,t.start,!0),this.setParams(!0,t.end,!1),this.setParams(!1,t.end,!1))}}]),t}();e.exports=l},{"./tools/element":10,"./tools/getter":12}],6:[function(t,e,n){"use strict";e.exports=function(t,e,n){t.target.className.split(" ").forEach(function(a){"function"==typeof e[a]&&e[a](t.target,n)})}},{}],7:[function(t,e,n){"use strict";var a=t("./../tools/getElementsByAttribute"),r=t("./../tools/element"),s=t("./../tools/getter");e.exports={reload:function(t,e){var n=(t.date,t.range,t.config),a=(t.rangeElements,t.interval,t.el),i=t.firstItem,o=t.targetElements;switch(n.type){case"single":e&&(t.range=null),t.date&&(t.targetElements=r.exchangeClass(o,s.format(t.date),a,["focus"]));break;case"range":e&&(t.date=null),t.range&&(t.rangeElements=r.choose(t.rangeElements,s.format(t.range.start),s.format(t.range.end),a,i));break;case"terminal":e&&(t.date=null,t.interval=t.range.diff("days")),t.range&&(t.rangeElements=r.choose(t.rangeElements,s.format(t.range.start),s.format(t.range.end),a))}},click:{"drp-day-number":function(t,e){var n=e.range,i=e.config,o=e.rangeElements,l=e.el,c=e.firstItem,u=e.targetElements,h=e.interval,m=e.selectFunc,d=i.maxDate,f=i.minDate,g=s.getDate(t),p=moment(g);if(h){if(d){var v=moment(d).subtract(h,"days");p.isAfter(v)&&(p=v,g=s.format(p),c=s.format(moment(d)))}if(f){var y=moment(f);p.isBefore(y)&&(p=y,g=s.format(p),c=s.format(moment(p).add(h,"days")))}}d&&p.isAfter(d)||f&&p.isBefore(f)||("single"===i.type?(e.date=p,m&&m(e.date),e.targetElements=r.exchangeClass(u,g,l,["focus"])):"range"===i.type?c?(e.range=moment(c).isBefore(g)?moment.range([c,g]):moment.range([g,c]),r.exChange(o),m&&m(e.range),e.firstItem=null):(r.clear(l,n),e.firstItem=g,e.targetElements=r.exchangeClass(u,g,l,["active"]),g=a(l,"date",e.firstItem),e.rangeElements=[g,[],g]):"terminal"===i.type&&(n&&r.clear(l,n),e.range=moment.range([g,c||g]),r.exChange(o),m&&m(e.range)))}},hover:{"drp-day-number":function(t,e){var n=(e.range,e.config),i=e.rangeElements,o=e.el,l=e.firstItem,c=(e.targetElements,e.interval),u=n.maxDate,h=n.minDate,m=s.getDate(t);if(u){var d=c?moment(u).subtract(c,"days"):moment(u);moment(m).isAfter(d)&&(m=s.format(d))}h&&moment(m).isBefore(h)&&(m=s.format(moment(h)));var f=c?moment(m).add(c,"days"):moment(m);o&&(a(o,"date",m).forEach(function(e){e!==t&&(e.classList.add("hover"),t.addEventListener("mouseout",function(){e.classList.remove("hover")}))}),"range"===n.type&&l&&(moment(l).isBefore(m)?e.rangeElements=r.choose(i,l,m,o,l):e.rangeElements=r.choose(i,m,l,o,l)),"terminal"===n.type&&(e.firstItem=s.format(f),e.rangeElements=r.choose(i,m,e.firstItem,o,e.firstItem)))}},leave:function(t){var e=t.config,n=t.rangeElements,a=t.targetElements,i=t.el,o=t.range;("range"===e.type||"terminal"===e.type)&&(r.clearRange(n,a),o&&(t.rangeElements=r.choose(n,s.format(o.start),s.format(o.end),i)),t.targetElements=[],t.firstItem=null)}}},{"./../tools/element":10,"./../tools/getElementsByAttribute":11,"./../tools/getter":12}],8:[function(t,e,n){"use strict";window.DateRangePicker=t("./DateRangePicker")},{"./DateRangePicker":2}],9:[function(t,e,n){"use strict";e.exports={"zh-cn":{today:"今天",yesterday:"昨天",lastWeek:"最近一周",lastMonth:"最近一月",custom:"自定义",day:"日",week:"周",month:"月",select:"选择",cancel:"取消"},en:{today:"today",yesterday:"yesterday",lastWeek:"last week",lastMonth:"last month",custom:"custom",day:"day",week:"week",month:"month",select:"select",cancel:"cancel"},ja:{today:"今日",yesterday:"昨日",lastWeek:"一週間",lastMonth:"一月間",custom:"カスタマ",day:"日",week:"週",month:"月",select:"選択",cancel:"キャンセル"}}},{}],10:[function(t,e,n){"use strict";function a(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}var r=t("./getElementsByAttribute"),s=t("./getter"),i=s.classArr,o=s.classFunc,l=s.format,c=s.getDate,u=function(t,e){var n=!0;return e.forEach(function(e){t.classList.contains(e)||(n=!1)}),n},h=function(t,e){var n=t.classList;if(u(t,e)){var r=t.className.split(" ");e.forEach(function(t){var e=r.indexOf(t);-1!==e&&r.splice(e,1)}),n.contains("hover")&&3===r.length||!n.contains("hover")&&2===r.length?(n.remove("active"),n.contains("focus")||n.remove("start","end")):n.remove.apply(n,a(e))}};e.exports={hasChild:function(t,e){var n=!1,a=function r(t){t===e&&(n=!0),t.childNodes&&t.childNodes.length&&r(t.childNodes[0]),t.nextSibling&&r(t.nextSibling)};return a(t),n},create:function(t,e,n){var a=document.createElement(t);return e&&(a.className=e),n&&("input"!==t?a.innderText=a.textContent=n:a.value=n),a},choose:function(t,e,n,s,i){var o=[],c=[],u=[],h=moment.range(e,n);h.by("days",function(t){var i=r(s,"date",l(t));t.isAfter(e)?t.isBefore(n)?c.push.apply(c,a(i)):u.push.apply(u,a(i)):o.push.apply(o,a(i))}),u[0]||o.forEach(function(t){-1===u.indexOf(t)&&u.push(t)});var m=[o,c,u];return t=this.change(t,m,i)},change:function(t,e,n){var r=null;return t.forEach(function(t,e){r=o(n,i[e]).split(" "),t.forEach(function(t){h(t,r)})}),e.forEach(function(e,s){r=o(n,i[s]).split(" "),e.forEach(function(e){if(!u(e,r)||t[0]===t[2]){var n;(n=e.classList).add.apply(n,a(r))}})}),e},clear:function(t,e){var n=null,a=null,s=null,o=moment.range([moment(e.start),moment(e.end)]);o.start.set({hour:0,minute:0,second:0}),o.by("days",function(e){switch(s=l(e)){case l(o.start):n=0;break;case l(o.end):n=2;break;default:n=1}a=r(t,"date",s),a.forEach(function(t){t.classList.remove("focus",i[n])})})},clearRange:function(t,e){t.forEach(function(t,e){t.forEach(function(t){h(t,["active",i[e]])})}),e.forEach(function(t){h(t,["active"])})},exChange:function(t){return t.forEach(function(t,e){t.forEach(function(t){t.classList.remove("active"),t.classList.add("focus",i[e])})}),t},exchangeClass:function(t,e,n,a){return a=a||"",t.forEach(function(t){c(t)!==e&&t&&h(t,a)}),t=[],r(n,"date",e).forEach(function(e){e.classList.add(a),t.push(e)}),t}}},{"./getElementsByAttribute":11,"./getter":12}],11:[function(t,e,n){"use strict";var a=function(t,e,n){return Array.prototype.slice.call(t.querySelectorAll("["+e+"='"+n+"']"))};e.exports=a},{}],12:[function(t,e,n){"use strict";e.exports={classArr:["start","segment","end"],getDate:function(t){return t.getAttribute("date")},format:function(t){return t.format("YYYY-MM-DD")},classFunc:function(t,e){return(t?"active ":"focus ")+e},zero:"2000-01-01 00:00"}},{}],13:[function(t,e,n){"use strict";var a=t("./element").hasChild,r=null,s=[];document.body.addEventListener("mouseover",function(t){r&&!a(r,t.target)&&(s.forEach(function(t){r===t.el&&t.callback()}),r=null)}),e.exports={add:function(t,e){s.push({el:t,callback:e})},getTarget:function(){return r},setTarget:function(t){r=t}}},{"./element":10}]},{},[8]);
