!function(t){if("object"==typeof exports)module.exports=t();else if("function"==typeof define&&define.amd)define(t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.DateRangePicker=t()}}(function(){return function t(e,n,a){function r(i,o){if(!n[i]){if(!e[i]){var l="function"==typeof require&&require;if(!o&&l)return l(i,!0);if(s)return s(i,!0);throw new Error("Cannot find module '"+i+"'")}var c=n[i]={exports:{}};e[i][0].call(c.exports,function(t){var n=e[i][1][t];return r(n?n:t)},c,c.exports,t,e,n,a)}return n[i].exports}for(var s="function"==typeof require&&require,i=0;i<a.length;i++)r(a[i]);return r}({1:[function(t,module,exports){"use strict";function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),a=t("./tools/element").create,r=moment(),s=function(){function t(n,r){e(this,t);var s=n.el,i=n.config,o=i.numberOfCalendars,l=i.lang,c=i.maxDate,u=i.minDate;this.el=a("div","drp-calendar"),this.parent=s,this.calNum=o,this.current=n.range?moment(n.range.start):n.date?moment(n.date):moment(),this.reload=r,this.lang=l,c&&(this.maxDate=c.endOf("day")),u&&(this.minDate=u.startOf("day")),this.draw(),s.appendChild(this.el)}return n(t,[{key:"draw",value:function(t){t&&(this.current=moment(t)),moment.locale(this.lang||"zh-cn"),this.el.innerHTML="",this.month=[],this.current=this.current.subtract(Math.ceil(this.calNum/2),"month"),this.drawPointer();for(var e=0;e<this.calNum;e++)this.current=this.current.date(1).add(1,"month"),this.drawHeader(e),this.drawMonth(e)}},{key:"drawPointer",value:function(){var t=this,e=a("div","drp-right");e.addEventListener("click",function(){t.nextMonth()});var n=a("div","drp-left");n.addEventListener("click",function(){t.prevMonth()}),this.parent.appendChild(e),this.parent.appendChild(n)}},{key:"drawHeader",value:function(t){this.header=a("div","drp-header",this.current.format("MMM YYYY")),this.el.appendChild(this.header),this.drawWeekDays(),this.header.innerHTML=this.current.format("MMM YYYY")}},{key:"drawMonth",value:function(t){this.month.push(a("div","drp-month")),this.backFill(),this.currentMonth(),this.fowardFill(),this.el.appendChild(this.month[this.month.length-1])}},{key:"backFill",value:function(){var t=this.current.clone(),e=t.day();if(e){t.subtract(e+1,"days");for(var n=e;n>0;n--)this.drawDay(t.add(1,"days"))}}},{key:"fowardFill",value:function(){var t=this.current.clone().add(1,"months").subtract(1,"days"),e=t.day();if(6!==e)for(var n=e;6>n;n++)this.drawDay(t.add(1,"days"))}},{key:"currentMonth",value:function(){for(var t=this.current.clone();t.month()===this.current.month();)this.drawDay(t),t.add(1,"days")}},{key:"getWeek",value:function(t){this.week&&0!==t.day()||(this.week=a("div","drp-week"),this.month[this.month.length-1].appendChild(this.week))}},{key:"drawDay",value:function(t){this.getWeek(t);var e=a("div",this.getDayClass(t)),n="drp-day-number";(this.minDate&&t.isBefore(this.minDate)||this.maxDate&&t.isAfter(this.maxDate))&&(n="drp-day-static");var r=a("div",n,t.format("DD"));r.setAttribute("date",t.format("YYYY-MM-DD")),e.appendChild(r),this.week.appendChild(e)}},{key:"getDayClass",value:function(t){var e=["drp-day"];return t.month()!==this.current.month()?e.push("drp-other"):r.isSame(t,"day")&&e.push("drp-today"),e.join(" ")}},{key:"drawWeekDays",value:function(t){var e=this;this.weekDays=a("div","drp-week-days");for(var n=[],r=0;7>r;r++)n.push(moment().weekday(r-1).format("ddd"));n.forEach(function(t){var n=a("span","drp-day",t);e.weekDays.appendChild(n)}),this.el.appendChild(this.weekDays)}},{key:"nextMonth",value:function(){this.current.subtract(Math.floor(this.calNum/2)-1,"months"),this.next=!0,this.draw(),this.reload()}},{key:"prevMonth",value:function(){this.current.subtract(Math.floor(this.calNum/2)+1,"months"),this.next=!1,this.draw(),this.reload()}}]),t}();module.exports=s},{"./tools/element":9}],2:[function(t,module,exports){"use strict";function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=(t("./tools/element").create,t("./lang"),function a(t,n){e(this,a)});module.exports=n},{"./lang":8,"./tools/element":9}],3:[function(t,module,exports){"use strict";function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),a=t("./tools/element").create,r=t("./lang"),s=t("./tools/getter").format,i=function(){function t(n,i){var o=this;e(this,t),this.lang=r[n.config.lang],this.el=i.el,this.btns=i.btns,this.dateEL=null,this.rangeStartEL=null,this.rangeEndEL=null,this.formEL=null,this.btns&&this.btns.length||(this.btns=["today","yesterday","lastWeek","lastMonth","custom"]),this.btns.forEach(function(t){o.lang[t]&&o.setBtn(n,o.lang[t])}),this.formEL=a("form","drp-shortcuts-form"),this.formEL.style.display="none";var l=a("button","drp-shortcuts-selectbtn",this.lang.select);if(l.type="button",-1!==this.btns.indexOf("custom")){var c=n.config,u=c.minDate,h=c.maxDate,d=c.type;"single"===d?(this.dateEL=a("input","drp-shortcuts-input",s(n.date)),this.formEL.appendChild(this.dateEL),this.formEL.appendChild(l),l.addEventListener("click",function(t){var e=moment(o.dateEL.value);e.isValid()&&(e.isBefore(u)&&(e=u),e.isAfter(h)&&(e=h),e.isSame(n.date)||(n.set("date",e),n.selectFunc())),o.dateEL.value=s(n.date)})):(this.rangeStartEL=a("input","drp-shortcuts-input",s(n.range.start)),this.rangeEndEL=a("input","drp-shortcuts-input",s(n.range.end)),this.formEL.appendChild(this.rangeStartEL),this.formEL.appendChild(this.rangeEndEL),this.formEL.appendChild(l),l.addEventListener("click",function(t){var e=moment(o.rangeStartEL.value),a=moment(o.rangeEndEL.value);e.isValid()&&a.isValid&&(e.isAfter(a)&&(e=a),e.isBefore(u)&&(e=u),a.isAfter(h)&&(a=h),moment.range(e,a).isSame(n.range)||(n.set("range",moment.range(e,a)),n.selectFunc())),o.rangeStartEL.value=s(n.range.start),o.rangeEndEL.value=s(n.range.end)}))}this.el.appendChild(this.formEL)}return n(t,[{key:"setBtn",value:function(t,e){var n=this;if("single"!==t.config.type||e!==this.lang.lastWeek&&e!==this.lang.lastMonth){var r=a("a","drp-shortcuts-btn",e);r.addEventListener("click",function(e){var a="single"===t.config.type,r=moment().startOf("day"),s=moment().startOf("day").subtract(1,"days"),i=-1!==n.btns.indexOf("today")&&-1===n.btns.indexOf("yesterday"),o=moment.range(i?moment(s).subtract(1,"days"):moment(r).subtract(6,"days"),i?s:r),l=moment.range(i?moment(s).subtract(1,"months").add(1,"days"):moment(r).subtract(1,"months").add(1,"days"),i?s:r);switch(n.exchangeButton(e.target),n.formEL.style.display="none",e.target.innerHTML){case n.lang.today:a?t.set("date",r):t.set("range",moment.range(r,r)),t.selectFunc();break;case n.lang.yesterday:a?t.set("date",s):t.set("range",moment.range(s,s)),t.selectFunc();break;case n.lang.lastWeek:a||t.set("range",o),t.selectFunc();break;case n.lang.lastMonth:a||t.set("range",l),t.selectFunc();break;case n.lang.custom:n.formEL.style.display="block"}}),this.el.appendChild(r)}}},{key:"setInput",value:function(t,e){"single"===t?this.dateEL.value=s(e):(this.rangeStartEL.value=s(e.start),this.rangeEndEL.value=s(e.end))}},{key:"exchangeButton",value:function(t){Array.prototype.slice.call(this.el.querySelectorAll(".drp-shortcuts-btn")).forEach(function(t){t.classList.remove("focus")}),t.classList.add("focus")}}]),t}();module.exports=i},{"./lang":8,"./tools/element":9,"./tools/getter":11}],4:[function(t,module,exports){"use strict";function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),a=t("./tools/element").create,r=t("./tools/getter"),s=r.zero,i=function(){function t(n){e(this,t);var a=n.el,r=n.config,s=n.selectFunc;this.el=a,this.config=r,this.selectFunc=s,this.hours=[],this.minutes=[],this.timeText=null,this.secondTimeText=null,this.input=[],this.init(n)}return n(t,[{key:"init",value:function(t){var e=this.config.type,n=a("div","drp-time");this.timeText=a("div","drp-time-text");var r=moment(s);if("single"===e)n.appendChild(this.timeText),n.appendChild(this.createInput(!0,t.date||r)),n.appendChild(this.createInput(!1,t.date||r));else if("range"===e||"terminal"===e){this.secondTimeText=a("div","drp-time-text");var i=t.range?t.range.start:r,o=t.range?t.range.end:r;n.appendChild(this.insertItemBox(this.timeText,this.createInput(!0,i,!0),this.createInput(!1,i,!0))),n.appendChild(this.insertItemBox(this.secondTimeText,this.createInput(!0,o,!1),this.createInput(!1,o,!1)))}this.el.appendChild(n)}},{key:"insertItemBox",value:function(t,e,n){var r=a("div","drp-time-item");return r.appendChild(t),r.appendChild(e),r.appendChild(n),r}},{key:"createInput",value:function(t,e,n){var r=this,s=a("input","drp-time-input");return s.type="range",s.min=0,s.max=t?23:59,this.input.push(s),this.setParams(t,e,n),s.addEventListener("input",function(a){e=t?e.hours(a.target.value):e.minutes(a.target.value),r.setParams(t,e,n),r.selectFunc(null)}),s}},{key:"setParams",value:function(t,e,n){var a=this.config.type;"single"===a?(this.timeText.innerHTML=e.format("LT"),t?this.input[0].value=this.hours[0]=e.format("HH"):this.input[1].value=this.minutes[0]=e.format("mm")):("range"===a||"terminal"===a)&&(n?(this.timeText.innerHTML=e.format("LT"),t?this.input[0].value=this.hours[0]=e.format("HH"):this.input[1].value=this.minutes[0]=e.format("mm")):(this.secondTimeText.innerHTML=e.format("LT"),t?this.input[2].value=this.hours[1]=e.format("HH"):this.input[3].value=this.minutes[1]=e.format("mm")))}},{key:"setTime",value:function(t){var e=this.config.type;"single"===e?(this.setParams(!0,t),this.setParams(!1,t)):("range"===e||"terminal"===e)&&(this.setParams(!0,t.start,!0),this.setParams(!1,t.start,!0),this.setParams(!0,t.end,!1),this.setParams(!1,t.end,!1))}}]),t}();module.exports=i},{"./tools/element":9,"./tools/getter":11}],5:[function(t,module,exports){"use strict";module.exports=function(t,e,n){t.target.className.split(" ").forEach(function(a){"function"==typeof e[a]&&e[a](t.target,n)})}},{}],6:[function(t,module,exports){"use strict";var e=t("./../tools/getElementsByAttribute"),n=t("./../tools/element"),a=t("./../tools/getter");module.exports={reload:function(t,e){var r=(t.date,t.range,t.config),s=(t.rangeElements,t.interval,t.el),i=t.firstItem,o=t.targetElements;switch(r.type){case"single":e&&(t.range=null),t.date&&(t.targetElements=n.exchangeClass(o,a.format(t.date),s,["focus"]));break;case"range":e&&(t.date=null),t.range&&(t.rangeElements=n.choose(t.rangeElements,a.format(t.range.start),a.format(t.range.end),s,i));break;case"terminal":e&&(t.date=null,t.interval=t.range.diff("days")),t.range&&(t.rangeElements=n.choose(t.rangeElements,a.format(t.range.start),a.format(t.range.end),s))}},click:{"drp-day-number":function(t,r){var s=r.range,i=r.config,o=r.rangeElements,l=r.el,c=r.firstItem,u=r.targetElements,h=r.interval,d=r.selectFunc,m=i.maxDate,f=i.minDate,g=a.getDate(t),p=moment(g);if(h){if(m){var v=moment(m).subtract(h,"days");p.isAfter(v)&&(p=v,g=a.format(p),c=a.format(moment(m)))}if(f){var y=moment(f);p.isBefore(y)&&(p=y,g=a.format(p),c=a.format(moment(p).add(h,"days")))}}m&&p.isAfter(m)||f&&p.isBefore(f)||("single"===i.type?(r.date=p,d&&d(r.date),r.targetElements=n.exchangeClass(u,g,l,["focus"])):"range"===i.type?c?(r.range=moment(c).isBefore(g)?moment.range([c,g]):moment.range([g,c]),n.exChange(o),d&&d(r.range),r.firstItem=null):(n.clear(l,s),r.firstItem=g,r.targetElements=n.exchangeClass(u,g,l,["active"]),g=e(l,"date",r.firstItem),r.rangeElements=[g,[],g]):"terminal"===i.type&&(s&&n.clear(l,s),r.range=moment.range([g,c||g]),n.exChange(o),d&&d(r.range)))}},hover:{"drp-day-number":function(t,r){var s=(r.range,r.config),i=r.rangeElements,o=r.el,l=r.firstItem,c=(r.targetElements,r.interval),u=s.maxDate,h=s.minDate,d=a.getDate(t);if(u){var m=c?moment(u).subtract(c,"days"):moment(u);moment(d).isAfter(m)&&(d=a.format(m))}h&&moment(d).isBefore(h)&&(d=a.format(moment(h)));var f=c?moment(d).add(c,"days"):moment(d);o&&(e(o,"date",d).forEach(function(e){e!==t&&(e.classList.add("hover"),t.addEventListener("mouseout",function(){e.classList.remove("hover")}))}),"range"===s.type&&l&&(moment(l).isBefore(d)?r.rangeElements=n.choose(i,l,d,o,l):r.rangeElements=n.choose(i,d,l,o,l)),"terminal"===s.type&&(r.firstItem=a.format(f),r.rangeElements=n.choose(i,d,r.firstItem,o,r.firstItem)))}},leave:function(t){var e=t.config,r=t.rangeElements,s=t.targetElements,i=t.el,o=t.range;"range"===e.type&&(n.clearRange(r,s),o&&(t.rangeElements=n.choose(r,a.format(o.start),a.format(o.end),i)),t.targetElements=[],t.firstItem=null)}}},{"./../tools/element":9,"./../tools/getElementsByAttribute":10,"./../tools/getter":11}],7:[function(t,module,exports){"use strict";function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),a=t("./Calendar"),r=t("./TimePicker"),s=t("./Shortcuts"),i=t("./Dimension"),o=t("./events/bind"),l=t("./events/events"),c=l.click,u=l.hover,h=l.reload,d=l.leave,m=t("./tools/mouseleave"),f=t("./tools/element"),g=t("./tools/getter"),p=g.zero,v=function(){function t(n,a){var r=this;e(this,t);var o=a.type,l=a.date,c=a.range,u=a.onSelect,h=a.lang,d=a.shortcuts,m=a.dimension;a.lang=h=h||"zh-cn",this.el=n,this.config=a,this.targetElements=[],this.rangeElements=[[],[],[]],this.firstItem=null,this.range=c?function(){return c.start=c.start.locale(h),c.end=c.end.locale(h),c}():null,this.date=l?l.locale(h):null,this.interval=null,this.time=null,this.calendar=null,d&&d.el&&(this.shortcuts=new s(this,d)),m&&m.el&&"terminal"===o&&(this.dimension=new i(this,d)),this.selectFunc=u?function(t){if("single"===o){if(t=t||r.date,r.shortcuts&&r.shortcuts.setInput(o,t),!r.time)return u(t);var e=r.time,n=e.hours,a=e.minutes;r.date=t.hours(n[0]).minutes(a[0]),u(r.date)}else if("range"===o||"terminal"===o){if(t=t||r.range,r.shortcuts&&r.shortcuts.setInput(o,t),!r.time)return u(t);var s=r.time,n=s.hours,a=s.minutes;r.range.start=t.start.hours(n[0]).minutes(a[0]),r.range.end=t.end.hours(n[1]).minutes(a[1]),u(r.range)}}:null,this.init()}return n(t,[{key:"init",value:function(){var t=this,e=this.el,n=this.config;this.calendar=new a(this,function(){h(t)}),n.time&&(this.time=new r(this)),e.className="drp",e.addEventListener("click",function(e){o(e,c,t)}),e.addEventListener("mouseover",function(n){o(n,u,t),m.getTarget(e)||m.setTarget(e)}),m.add(e,function(){d(t)}),h(this,!0)}},{key:"set",value:function(t,e){if("undefined"!=typeof this[t]&&e){var n=this.config,a=n.type,r=n.lang;if("date"===t){if(this.date&&this.date.isSame(e))return;e=e.locale(r),this.shortcuts&&this.shortcuts.setInput(a,e)}else if("range"===t||"terminal"===a){if(this.range&&this.range.isSame(e))return;e.start=e.start.locale(r),e.end=e.end.locale(r),"terminal"===a&&(this.interval=e.diff("days")),this.shortcuts&&this.shortcuts.setInput(a,e)}this[t]=e,this.time&&this.time.setTime(e),this.calendar.draw(e.start||e),h(this)}}},{key:"clear",value:function(){var t=this.el,e=this.date,n=this.range;this.config;n&&(f.clear(t,n),this.range=null,this.time&&this.time.setTime(moment.range([p,p]))),e&&(f.exchangeClass(this.targetElements,"",t,["focus"]),this.date=null,this.time&&this.time.setTime(moment(p)))}}]),t}();module.exports=v},{"./Calendar":1,"./Dimension":2,"./Shortcuts":3,"./TimePicker":4,"./events/bind":5,"./events/events":6,"./tools/element":9,"./tools/getter":11,"./tools/mouseleave":12}],8:[function(t,module,exports){"use strict";module.exports={"zh-cn":{today:"今天",yesterday:"昨天",lastWeek:"最近一周",lastMonth:"最近一月",custom:"自定义",day:"日",week:"周",month:"月",select:"选择",cancel:"取消"},en:{today:"today",yesterday:"yesterday",lastWeek:"last week",lastMonth:"last month",custom:"custom",day:"day",week:"week",month:"month",select:"select",cancel:"cancel"},ja:{today:"今日",yesterday:"昨日",lastWeek:"一週間",lastMonth:"一月間",custom:"カスタマ",day:"日",week:"週",month:"月",select:"選択",cancel:"キャンセル"}}},{}],9:[function(t,module,exports){"use strict";function e(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}var n=t("./getElementsByAttribute"),a=t("./getter"),r=a.classArr,s=a.classFunc,i=a.format,o=a.getDate,l=function(t,e){var n=!0;return e.forEach(function(e){t.classList.contains(e)||(n=!1)}),n},c=function(t,n){var a=t.classList;if(l(t,n)){var r=t.className.split(" ");n.forEach(function(t){var e=r.indexOf(t);-1!==e&&r.splice(e,1)}),a.contains("hover")&&3===r.length||!a.contains("hover")&&2===r.length?(a.remove("active"),a.contains("focus")||a.remove("start","end")):a.remove.apply(a,e(n))}};module.exports={hasChild:function(t,e){var n=!1,a=function r(t){t===e&&(n=!0),t.childNodes&&t.childNodes.length&&r(t.childNodes[0]),t.nextSibling&&r(t.nextSibling)};return a(t),n},create:function(t,e,n){var a=document.createElement(t);return e&&(a.className=e),n&&("input"!==t?a.innderText=a.textContent=n:a.value=n),a},choose:function(t,a,r,s,o){var l=[],c=[],u=[],h=moment.range(a,r);h.by("days",function(t){var o=n(s,"date",i(t));t.isAfter(a)?t.isBefore(r)?c.push.apply(c,e(o)):u.push.apply(u,e(o)):l.push.apply(l,e(o))}),u[0]||l.forEach(function(t){-1===u.indexOf(t)&&u.push(t)});var d=[l,c,u];return t=this.change(t,d,o)},change:function(t,n,a){var i=null;return t.forEach(function(t,e){i=s(a,r[e]).split(" "),t.forEach(function(t){c(t,i)})}),n.forEach(function(n,o){i=s(a,r[o]).split(" "),n.forEach(function(n){if(!l(n,i)||t[0]===t[2]){var a;(a=n.classList).add.apply(a,e(i))}})}),n},clear:function(t,e){var a=null,s=null,o=null,l=moment.range([moment(e.start),moment(e.end)]);l.start.set({hour:0,minute:0,second:0}),l.by("days",function(e){switch(o=i(e)){case i(l.start):a=0;break;case i(l.end):a=2;break;default:a=1}s=n(t,"date",o),s.forEach(function(t){t.classList.remove("focus",r[a])})})},clearRange:function(t,e){t.forEach(function(t,e){t.forEach(function(t){c(t,["active",r[e]])})}),e.forEach(function(t){c(t,["active"])})},exChange:function(t){return t.forEach(function(t,e){t.forEach(function(t){t.classList.remove("active"),t.classList.add("focus",r[e])})}),t},exchangeClass:function(t,e,a,r){return r=r||"",t.forEach(function(t){o(t)!==e&&t&&c(t,r)}),t=[],n(a,"date",e).forEach(function(e){e.classList.add(r),t.push(e)}),t}}},{"./getElementsByAttribute":10,"./getter":11}],10:[function(t,module,exports){"use strict";var e=function(t,e,n){return Array.prototype.slice.call(t.querySelectorAll("["+e+"='"+n+"']"))};module.exports=e},{}],11:[function(t,module,exports){"use strict";module.exports={classArr:["start","segment","end"],getDate:function(t){return t.getAttribute("date")},format:function(t){return t.format("YYYY-MM-DD")},classFunc:function(t,e){return(t?"active ":"focus ")+e},zero:"2000-01-01 00:00"}},{}],12:[function(t,module,exports){"use strict";var e=t("./element").hasChild,n=null,a=[];document.body.addEventListener("mouseover",function(t){n&&!e(n,t.target)&&(a.forEach(function(t){n===t.el&&t.callback()}),n=null)}),module.exports={add:function(t,e){a.push({el:t,callback:e})},getTarget:function(){return n},setTarget:function(t){n=t}}},{"./element":9}]},{},[7])(7)});
